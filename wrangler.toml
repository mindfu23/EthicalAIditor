# Cloudflare Worker configuration for EthicalAIditor
# API proxy with auth, rate limiting, and HuggingFace integration

name = "ethicalaiditor-api"
main = "worker/index.js"
compatibility_date = "2024-01-01"

# D1 Database binding
[[d1_databases]]
binding = "DB"
database_name = "ethicalaiditor-db"
database_id = "0b5f486e-728d-4ba8-88d3-013feeefc064" # Run: wrangler d1 create ethicalaiditor-db

# Vectorize binding for RAG embeddings
# Create with: wrangler vectorize create ethicalaiditor-vectors --dimensions=384 --metric=cosine
[[vectorize]]
binding = "VECTORIZE"
index_name = "ethicalaiditor-vectors"

# AI binding for embeddings generation
[ai]
binding = "AI"

# Environment variables (set via: wrangler secret put <SECRET_NAME>)
# HUGGINGFACE_API_KEY - Required for AI model inference
# JWT_SECRET - Required for tenant session signing (generate with: openssl rand -base64 32)

[vars]
ENVIRONMENT = "production"
# LLM_API_URL = "https://llm-api-1097587800570.us-central1.run.app"

# Development settings
[dev]
port = 8787
local_protocol = "http"
